
%,4,5 together
clear
clc

DataNew1=load('DataNew.mat');
DataNew=DataNew1.DataNew;
Year=DataNew(1:end,3);
Lat1=DataNew(1:end,4);
Le1=DataNew(1:end,2);

chlo=load('chloroph.mat');
cha=chlo.Cha_Year_mean;

idx_year=find(Year>=1993 & Year<=2020);
Y=Year(idx_year);
Lat=Lat1(idx_year);
Level=Le1(idx_year);

idx1=find(Level==1);
idx2=find(Level==2);    
idx3=find(Level==3);
idx4=find(Level==4);
idx5=find(Level==5);

idx45=[idx4;idx5];

[Lat_level1_mean]=ComputeChaAndLatMean(Lat,Y,idx1);
[Lat_level2_mean]=ComputeChaAndLatMean(Lat,Y,idx2);
[Lat_level3_mean]=ComputeChaAndLatMean(Lat,Y,idx3);
[Lat_level4_mean]=ComputeChaAndLatMean(Lat,Y,idx45);

cha_year_mean=mean(cha(1:360,:));

chlo=load('chloroph.mat');
cha=chlo.Cha_Year_mean;
Lat=0:0.25:90;
for k=1:28
    CC=cha(:,k);
    a1=0;
    for i=1:360
        a1=a1+Lat(i)*CC(i);
    end
    Lat_C(k)=a1/sum(CC(1:360));
end
 
%%
Year=1993:2020;
figure(1)
subplot(221)
[datafit1]=Confidednce95Interval(Lat_C,Lat_level1_mean)
hold on
[AdjustedR2]=ColorFig(Lat_C,Lat_level1_mean)
xlim([44,47.3]);
ylim([45,58]);
title('Trophic level 1 vs Chlorophyll-a')
set(gca,'CLim',[1 28],'Colormap',...
    [0 0 1;0.0370370373129845 0 0.962962985038757;0.0740740746259689 0 0.92592591047287;0.111111111938953 0 0.888888895511627;0.148148149251938 0 0.851851880550385;0.185185179114342 0 0.814814805984497;0.222222223877907 0 0.777777791023254;0.259259253740311 0 0.740740716457367;0.296296298503876 0 0.703703701496124;0.333333343267441 0 0.666666686534882;0.370370358228683 0 0.629629611968994;0.407407402992249 0 0.592592597007751;0.444444447755814 0 0.555555582046509;0.481481492519379 0 0.518518507480621;0.518518507480621 0 0.481481492519379;0.555555582046509 0 0.444444447755814;0.592592597007751 0 0.407407402992249;0.629629611968994 0 0.370370358228683;0.666666686534882 0 0.333333343267441;0.703703701496124 0 0.296296298503876;0.740740716457367 0 0.259259253740311;0.777777791023254 0 0.222222223877907;0.814814805984497 0 0.185185179114342;0.851851880550385 0 0.148148149251938;0.888888895511627 0 0.111111111938953;0.92592591047287 0 0.0740740746259689;0.962962985038757 0 0.0370370373129845;1 0 0],...
    'FontName','Arial','FontSize',15,'FontWeight','bold','GridAlpha',0.05,...
    'LineWidth',2);
colorbar(gca,'Ticks',[1 8 18 28],...
    'TickLabels',{'1993','2000','2010','2020'})
ylabel('Latitude(\circN)')
set(gca,'Position',[0.1,0.55,0.2,0.35])

subplot(222)
[datafit1]=Confidednce95Interval(Lat_C,Lat_level2_mean)
hold on
[AdjustedR2]=ColorFig(Lat_C,Lat_level2_mean)
xlim([44,47.3]);
ylim([45,58]);
title('Trophic level 2 vs Chlorophyll-a')
set(gca,'CLim',[1 28],'Colormap',...
    [0 0 1;0.0370370373129845 0 0.962962985038757;0.0740740746259689 0 0.92592591047287;0.111111111938953 0 0.888888895511627;0.148148149251938 0 0.851851880550385;0.185185179114342 0 0.814814805984497;0.222222223877907 0 0.777777791023254;0.259259253740311 0 0.740740716457367;0.296296298503876 0 0.703703701496124;0.333333343267441 0 0.666666686534882;0.370370358228683 0 0.629629611968994;0.407407402992249 0 0.592592597007751;0.444444447755814 0 0.555555582046509;0.481481492519379 0 0.518518507480621;0.518518507480621 0 0.481481492519379;0.555555582046509 0 0.444444447755814;0.592592597007751 0 0.407407402992249;0.629629611968994 0 0.370370358228683;0.666666686534882 0 0.333333343267441;0.703703701496124 0 0.296296298503876;0.740740716457367 0 0.259259253740311;0.777777791023254 0 0.222222223877907;0.814814805984497 0 0.185185179114342;0.851851880550385 0 0.148148149251938;0.888888895511627 0 0.111111111938953;0.92592591047287 0 0.0740740746259689;0.962962985038757 0 0.0370370373129845;1 0 0],...
    'FontName','Arial','FontSize',15,'FontWeight','bold','GridAlpha',0.05,...
    'LineWidth',2);
colorbar(gca,'Ticks',[1 8 18 28],...
    'TickLabels',{'1993','2000','2010','2020'})
set(gca,'Position',[0.35,0.55,0.2,0.35])

subplot(223)
[datafit1]=Confidednce95Interval(Lat_C,Lat_level3_mean)
hold on
[AdjustedR2]=ColorFig(Lat_C,Lat_level3_mean)
xlim([44,47.3]);
ylim([45,58]);
title('Trophic level 3 vs Chlorophyll-a')
set(gca,'CLim',[1 28],'Colormap',...
    [0 0 1;0.0370370373129845 0 0.962962985038757;0.0740740746259689 0 0.92592591047287;0.111111111938953 0 0.888888895511627;0.148148149251938 0 0.851851880550385;0.185185179114342 0 0.814814805984497;0.222222223877907 0 0.777777791023254;0.259259253740311 0 0.740740716457367;0.296296298503876 0 0.703703701496124;0.333333343267441 0 0.666666686534882;0.370370358228683 0 0.629629611968994;0.407407402992249 0 0.592592597007751;0.444444447755814 0 0.555555582046509;0.481481492519379 0 0.518518507480621;0.518518507480621 0 0.481481492519379;0.555555582046509 0 0.444444447755814;0.592592597007751 0 0.407407402992249;0.629629611968994 0 0.370370358228683;0.666666686534882 0 0.333333343267441;0.703703701496124 0 0.296296298503876;0.740740716457367 0 0.259259253740311;0.777777791023254 0 0.222222223877907;0.814814805984497 0 0.185185179114342;0.851851880550385 0 0.148148149251938;0.888888895511627 0 0.111111111938953;0.92592591047287 0 0.0740740746259689;0.962962985038757 0 0.0370370373129845;1 0 0],...
    'FontName','Arial','FontSize',15,'FontWeight','bold','GridAlpha',0.05,...
    'LineWidth',2);
colorbar(gca,'Ticks',[1 8 18 28],...
    'TickLabels',{'1993','2000','2010','2020'})
xlabel('Latitude(\circN)')
ylabel('Latitude(\circN)')
set(gca,'Position',[0.1,0.1,0.2,0.35])

subplot(224)
[datafit1]=Confidednce95Interval(Lat_C,Lat_level4_mean)
hold on
[AdjustedR2]=ColorFig(Lat_C,Lat_level4_mean)
xlim([44,47.3]);
ylim([45,58]);
title('Trophic level 4,5 vs Chlorophyll-a')
set(gca,'CLim',[1 28],'Colormap',...
    [0 0 1;0.0370370373129845 0 0.962962985038757;0.0740740746259689 0 0.92592591047287;0.111111111938953 0 0.888888895511627;0.148148149251938 0 0.851851880550385;0.185185179114342 0 0.814814805984497;0.222222223877907 0 0.777777791023254;0.259259253740311 0 0.740740716457367;0.296296298503876 0 0.703703701496124;0.333333343267441 0 0.666666686534882;0.370370358228683 0 0.629629611968994;0.407407402992249 0 0.592592597007751;0.444444447755814 0 0.555555582046509;0.481481492519379 0 0.518518507480621;0.518518507480621 0 0.481481492519379;0.555555582046509 0 0.444444447755814;0.592592597007751 0 0.407407402992249;0.629629611968994 0 0.370370358228683;0.666666686534882 0 0.333333343267441;0.703703701496124 0 0.296296298503876;0.740740716457367 0 0.259259253740311;0.777777791023254 0 0.222222223877907;0.814814805984497 0 0.185185179114342;0.851851880550385 0 0.148148149251938;0.888888895511627 0 0.111111111938953;0.92592591047287 0 0.0740740746259689;0.962962985038757 0 0.0370370373129845;1 0 0],...
    'FontName','Arial','FontSize',15,'FontWeight','bold','GridAlpha',0.05,...
    'LineWidth',2);
colorbar(gca,'Ticks',[1 8 18 28],...
    'TickLabels',{'1993','2000','2010','2020'})
xlabel('Latitude(\circN)')
set(gca,'Position',[0.35,0.1,0.2,0.35])
